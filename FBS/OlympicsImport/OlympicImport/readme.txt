Импорт сведений об олимпиадах школьников

1. Параметры запуска:

olympicimport.exe <имя_файла>

где <имя_файла> путь к файлу данных, содержащего сведения об олимпиадах

Настройки в файле OlympicImport.exe.config размещены в тэге appSettings

key="OlympicYear" (int) - год олимпиады (если не задан, то используется текущий год).

key="RemoveOlympics" (true|false) - удаление данных из таблицы [dbo].[Olympics] и в связанных с ней таблицах 
                       [dbo].[OlympicDiplomants], [dbo].[OlympicParticipants], 
					   [dbo].[OlympicThemeSubjects], [dbo].[OlympicProfileSubjects]
					   Значение по-умолчанию: true

key="RemoveDiplomants" (true|false) - удаление данных из таблицы [dbo].[OlympicDiplomants] и связанной с ней [dbo].[OlympicParticipants].
					   Значение по-умолчанию: true

key="RemoveSubjects" (true|false) - удаление данных из таблицы [dbo].[OlympicSubjects] и связанной с ней [dbo].[OlympicToFbsSubjectMap].
                       Значение по-умолчанию: true

2. Настройка БД

В файле OlympicImport.exe.config необходимо отредактировать строку соединения с базой ФБС (имя строки соединения FbsConnectionString).
Указывается соединение с базой, в которую будет производиться импорт данных. Это должна быть база ФБС или другая, содержащая таблицу [dat].[Subjects] 
и все необходимые таблицы для хранения сведений об олимпиадах и участниках.

3. Требования к файлу

Файл должен быть строго в текстовом формате (не xlsx).
Кодировка файла: UTF-8
Символ разделителя: #
Из-за проблем с экранированием двойных кавычек (") и возникающих в связи с этим ошибок распознавания рекомендуется заменить все двойные кавычки (") на одинарные (').
Это можно сделать с помощью редактора файлов в FAR (F4 для открытия файла на редактирование, далее Ctrl+F7 для поиска " и замены на ')
В файле может присутствовать последняя строка, содержащая общее количество записей. Эту строку необходимо удалить из файла.
